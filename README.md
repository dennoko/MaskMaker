# MaskMaker (UV Mask Maker)

Unity エディタ拡張。メッシュの UV アイランドを解析し、選択したアイランド領域をマスク (PNG もしくは頂点カラー) として出力できます。簡易なテクスチャマスク制作やチャンネル埋め込み、頂点カラーを利用したマテリアル制御に役立ちます。

## 主な機能
- UV アイランド解析 (シーム / ボーダー検出)
- シーンビュー上でメッシュを直接クリックしてアイランド選択 (Add / Remove モード + ホットキー切替)
- Invert / Select All / Clear 等の選択操作
- ピクセルマージン (膨張) によるブリーディング対策
- 512 / 1024 / 2048 / 4096 サイズでのプレビュー & 出力
- PNG 書き出し (選択部=黒 / それ以外=白)
- 既存 PNG の指定チャンネル (R/G/B/A) へ上書き書き込み (チャンネル単位書き込み)
- ベース PNG が無い場合はマスク値で新規生成
- 頂点カラーへのベイク (通常 / チャンネル別) ＋ 既存メッシュ頂点カラーを基に差分上書き
- SkinnedMeshRenderer のポーズを Bake して精度の高いピッキング (任意で Baked Mesh 使用)
- シーム色・選択色・プレビュー色・太さ・Z オフセット等のカスタマイズ
- ベーステクスチャ (BaseMap/MainTex) 上へ半透明オーバーレイ表示
- ログ出力 (Logs/UVMaskMaker/UVMaskMaker.log)

## 使い方 (概要)
1. メニュー: Tools > "UV Mask Maker (EN)" を開く
2. 対象オブジェクト (MeshRenderer / SkinnedMeshRenderer) をドラッグ&ドロップ
3. "Analyze UVs" でアイランド解析
4. シーンビューで左クリック: Add / Remove モードに応じて選択切替 (デフォルト R キーでモード切替)
5. 必要に応じて Pixel Margin や色 / Overlay 設定を調整
6. Export セクションでサイズ・ファイル名・出力先を設定
7. (任意) Channel-wise write を展開し、既存 PNG や書き込みチャンネルを指定
8. "Save PNG" でマスク出力、または "Bake to Vertex Colors" で頂点カラー保存

## 出力仕様 (デフォルト PNG)
- 選択部: 黒 (0,0,0,255)
- 非選択部: 白 (255,255,255,255)
- Pixel Margin は黒領域を膨張してシーム近辺の色滲みを防止

## チャンネル別書き込み
- ベース PNG 指定時: 選択ピクセルのみ対象チャンネルを黒(0)に上書き (A 選択時は 255)
- ベース PNG 無し: 指定チャンネル全体をマスク値で生成 (選択=黒 / 非選択=白, A は選択=255/非選択=0)

## 頂点カラー
- 通常: 選択頂点を黒 (RGB=0, A=255)、その他を白
- チャンネル別: 指定チャンネルのみ上書き (ベース頂点カラーがある場合は未選択頂点保持)
- 保存先は元メッシュと同階層に `VertexColorMasks` フォルダを自動生成

## インストール
`Assets/Editor` など Editor コンパイル対象フォルダに本スクリプト群を配置してください。(
`UVMaskMakerWindow_en.cs` は EditorWindow のため Editor アセンブリに置く必要があります。)

## 制限 / 注意
- Mesh が Read/Write 有効でない場合は解析不可
- UV0 (チャンネル0) のみ解析対象
- スキニング Bake はエディタ上の現在ポーズを取得 (アニメ再生中の中間姿勢など)

## ライセンス
本プロジェクトは MIT License です。詳細は `LICENSE` を参照してください。

## Author
(c) 2025 dennoko
